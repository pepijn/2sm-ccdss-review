#!/bin/bash

set -euxo pipefail

FRAGMENTS="fragments/$(basename "$1" .pdf).yml"
ELEMENTS="elements/$(basename "$1" .pdf).yml"

touch $ELEMENTS

TMP=$(gmktemp --suffix .org)
python2 extract2.py "$FRAGMENTS" < "$1" \
        | python2 summarize2.py "$ELEMENTS" > $TMP

$EDITOR "$TMP"

python2 save_elements.py < "$TMP" > "$ELEMENTS"
